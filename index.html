<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ClearPro Trading - Live Trading Signals</title>
    <link rel="manifest" href="/manifest.json">
    <img src="clearpro-logo.png" alt="ClearPro Logo">
    <style>
        /* Enhanced CSS for Android App */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #121212;
            color: #e0e0e0;
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 60px;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        /* Header Styles */
        /* Logo Icon */
.logo-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: white;
    font-size: 18px;
    margin-right: 10px;
}

/* Header */
header {
    display: flex;
    align-items: center;
    background-color: #ffffff;
    padding: 12px 24px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

header img {
    height: 28px;
    width: auto;
    margin-right: 8px;
}

header h1 {
    font-size: 1.3rem;
    margin: 0;
    color: #1a1a2e;
    font-weight: 600;
}

/* Splash logo size */
#splash img {
    width: 120px;
    height: auto;
    animation: fadeIn 1.5s ease-in-out;
}

@media (max-width: 600px) {
    header h1 {
        font-size: 1.1rem;
    }
    .logo-icon {
        width: 32px;
        height: 32px;
        font-size: 16px;
    }
}
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #37474f;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #90a4ae;
            cursor: pointer;
        }
        
        /* Dashboard Styles */
        .dashboard {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .balance {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .balance-label {
            font-size: 14px;
            color: #bbdefb;
        }
        
        .balance-amount {
            font-size: 24px;
            font-weight: bold;
        }
        
        .profit {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .profit-positive {
            color: #4caf50;
        }
        
        .profit-negative {
            color: #f44336;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 12px;
            color: #bbdefb;
        }
        
        /* Section Titles */
        .section-title {
            font-size: 18px;
            margin: 20px 0 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .view-all {
            font-size: 14px;
            color: #4fc3f7;
            cursor: pointer;
        }
        
        /* Opportunity Cards */
        .opportunity-card {
            background-color: #1e293b;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4fc3f7;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .opportunity-card.stock {
            border-left-color: #4fc3f7;
        }

        .opportunity-card.forex {
            border-left-color: #ff9800;
        }

        .opportunity-card.crypto {
            border-left-color: #9c27b0;
        }
        
        .opportunity-card:active {
            transform: scale(0.98);
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
        }
        
        .opportunity-card.new {
            animation: highlight 2s ease-in-out;
        }
        
        @keyframes highlight {
            0% { background-color: #2d3748; }
            100% { background-color: #1e293b; }
        }
        
        .opportunity-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .asset {
            font-weight: bold;
            font-size: 16px;
        }

        .asset-type {
            font-size: 12px;
            color: #90a4ae;
            margin-top: 2px;
        }
        
        .trend {
            font-size: 14px;
            padding: 3px 8px;
            border-radius: 5px;
        }
        
        .trend-up {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        
        .trend-down {
            background-color: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        .opportunity-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .expert {
            color: #90a4ae;
        }
        
        .risk-level {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .risk-low {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        
        .risk-medium {
            background-color: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }
        
        .risk-high {
            background-color: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        .opportunity-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }
        
        .time-remaining {
            font-size: 12px;
            color: #90a4ae;
        }
        
        .action-btn {
            background-color: #4fc3f7;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            touch-action: manipulation;
        }
        
        .action-btn:active {
            background-color: #29b6f6;
            transform: scale(0.95);
        }

        /* Section Styles */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #1a1a2e;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid #2d3748;
            max-width: 480px;
            margin: 0 auto;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #90a4ae;
            font-size: 12px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 10px;
            transition: background-color 0.2s;
        }
        
        .nav-item:active {
            background-color: rgba(79, 195, 247, 0.1);
        }
        
        .nav-item.active {
            color: #4fc3f7;
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 3px;
        }
        
        /* Filter Tabs */
        .filter-tabs {
            display: flex;
            margin: 15px 0;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .filter-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .filter-tab {
            padding: 8px 15px;
            background-color: #1e293b;
            border-radius: 20px;
            margin-right: 10px;
            white-space: nowrap;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .filter-tab:active {
            transform: scale(0.95);
        }
        
        .filter-tab.active {
            background-color: #4fc3f7;
            color: white;
        }
        
        /* Expert Cards */
        .expert-card {
            background-color: #1e293b;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            transition: transform 0.2s;
            cursor: pointer;
        }
        
        .expert-card:active {
            transform: scale(0.98);
        }
        
        .expert-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #37474f;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #90a4ae;
            margin-right: 15px;
            font-size: 20px;
        }
        
        .expert-info {
            flex: 1;
        }
        
        .expert-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .expert-specialty {
            font-size: 14px;
            color: #90a4ae;
            margin-bottom: 5px;
        }
        
        .expert-rating {
            display: flex;
            align-items: center;
            font-size: 14px;
        }
        
        .rating-stars {
            color: #ffc107;
            margin-right: 5px;
        }

        /* Portfolio Section */
        .portfolio-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background-color: #1e293b;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .stat-card .value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-size: 12px;
            color: #90a4ae;
        }

        .performance-chart {
            background-color: #1e293b;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .chart-placeholder {
            height: 150px;
            background: linear-gradient(135deg, #2d3748 0%, #1e293b 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #90a4ae;
            font-size: 14px;
        }

        /* Settings Section */
        .settings-section {
            background-color: #1e293b;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .settings-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #4fc3f7;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #2d3748;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-size: 14px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #2d3748;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4fc3f7;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .select-setting {
            background-color: #2d3748;
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
        }
        
        /* Connection Status */
        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .connected {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        
        .disconnected {
            background-color: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        /* Loading States */
        .loading {
            text-align: center;
            padding: 20px;
            color: #90a4ae;
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 15px;
            padding: 20px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .modal-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: bold;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #90a4ae;
            font-size: 24px;
            cursor: pointer;
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #323232;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 3000;
            opacity: 0;
            transition: opacity 0.3s;
            max-width: 90%;
            text-align: center;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        /* Swipe to refresh */
        .pull-to-refresh {
            text-align: center;
            padding: 10px;
            color: #90a4ae;
            font-size: 14px;
        }
        
        /* Android-specific optimizations */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .dashboard {
                padding: 15px;
            }
            
            .opportunity-card, .expert-card {
                padding: 12px;
            }
            
            .action-btn {
                padding: 10px 16px; /* Larger touch target */
            }
        }

        /* Price change indicators */
        .price-up {
            color: #4caf50;
        }
        
        .price-down {
            color: #f44336;
        }
        
        .price-change {
            font-size: 12px;
            margin-left: 5px;
        }

        /* Asset type badges */
        .asset-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: 5px;
            font-weight: bold;
        }

        .badge-stock {
            background-color: rgba(79, 195, 247, 0.2);
            color: #4fc3f7;
        }

        .badge-forex {
            background-color: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }

        .badge-crypto {
            background-color: rgba(156, 39, 176, 0.2);
            color: #9c27b0;
        }

        /* Error states */
        .error-state {
            text-align: center;
            padding: 40px 20px;
            color: #90a4ae;
        }

        .error-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .retry-btn {
            background-color: #4fc3f7;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="connection-status disconnected" id="connectionStatus">
        Connecting...
    </div>
    
    <div class="toast" id="toast"></div>
    
    <!-- Trade Execution Modal -->
    <div class="modal" id="tradeModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="tradeModalTitle">Execute Trade</div>
                <button class="close-modal" id="closeTradeModal">&times;</button>
            </div>
            <div id="tradeModalBody">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

    <!-- Signal Details Modal -->
    <div class="modal" id="signalModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="signalModalTitle">Signal Details</div>
                <button class="close-modal" id="closeSignalModal">&times;</button>
            </div>
            <div id="signalModalBody">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>
    
    <div class="container">
        <header>
            <div class="logo">
                <header>
    <div class="logo-icon">C</div>
    <h1>Trading Advisor</h1>
</header>
            <div class="user-avatar" id="userMenu">
                <span>JD</span>
            </div>
        </header>
        
        <!-- Opportunities Section -->
        <div class="section active" id="opportunitiesSection">
            <div class="dashboard" id="portfolioDashboard">
                <div class="balance">
                    <div class="balance-label">Portfolio Value</div>
                    <div class="balance-amount">$--.--</div>
                </div>
                <div class="profit">
                    <div class="balance-label">Today's Profit/Loss</div>
                    <div class="profit-positive">+$--.--</div>
                </div>
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value">--</div>
                        <div class="stat-label">Open Trades</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">--%</div>
                        <div class="stat-label">Win Rate</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">-.-</div>
                        <div class="stat-label">Risk Ratio</div>
                    </div>
                </div>
            </div>
            
            <div class="pull-to-refresh" id="pullToRefresh">
                ↓ Pull to refresh
            </div>
            
            <div class="section-title">
                <h2>Live Trading Opportunities</h2>
                <span class="view-all" id="viewAllSignals">View All</span>
            </div>
            
            <div class="filter-tabs">
                <div class="filter-tab active" data-filter="all">All</div>
                <div class="filter-tab" data-filter="stocks">Stocks</div>
                <div class="filter-tab" data-filter="forex">Forex</div>
                <div class="filter-tab" data-filter="crypto">Crypto</div>
                <div class="filter-tab" data-filter="low">Low Risk</div>
            </div>
            
            <div id="opportunitiesContainer">
                <div class="loading pulse">Connecting to live trading data...</div>
            </div>
        </div>

        <!-- Experts Section -->
        <div class="section" id="expertsSection">
            <div class="section-title">
                <h2>Top Trading Experts</h2>
                <span class="view-all" id="viewAllExperts">View All</span>
            </div>
            
            <div id="expertsContainer">
                <div class="loading pulse">Loading expert data from server...</div>
            </div>

            <div class="section-title" style="margin-top: 30px;">
                <h2>Expert Performance</h2>
            </div>
            
            <div class="performance-chart">
                <div class="chart-placeholder">
                    Loading performance data...
                </div>
            </div>
        </div>

        <!-- Portfolio Section -->
        <div class="section" id="portfolioSection">
            <div class="section-title">
                <h2>My Portfolio</h2>
            </div>

            <div class="dashboard">
                <div class="balance">
                    <div class="balance-label">Total Balance</div>
                    <div class="balance-amount">$--.--</div>
                </div>
                <div class="profit">
                    <div class="balance-label">Today's P&L</div>
                    <div class="profit-positive">+$--.--</div>
                </div>
            </div>

            <div class="portfolio-stats">
                <div class="stat-card">
                    <div class="value">--</div>
                    <div class="label">Open Trades</div>
                </div>
                <div class="stat-card">
                    <div class="value">--%</div>
                    <div class="label">Win Rate</div>
                </div>
                <div class="stat-card">
                    <div class="value">-.-</div>
                    <div class="label">Risk Ratio</div>
                </div>
                <div class="stat-card">
                    <div class="value">--</div>
                    <div class="label">Total Trades</div>
                </div>
            </div>

            <div class="section-title">
                <h2>Performance</h2>
            </div>

            <div class="performance-chart">
                <div class="chart-placeholder">
                    Loading portfolio performance...
                </div>
            </div>

            <div class="section-title">
                <h2>Active Trades</h2>
            </div>

            <div id="activeTradesContainer">
                <div class="loading">Loading active trades from server...</div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="section" id="settingsSection">
            <div class="section-title">
                <h2>Settings</h2>
            </div>

            <div class="settings-section">
                <div class="settings-title">Notifications</div>
                <div class="setting-item">
                    <div class="setting-label">Push Notifications</div>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Email Alerts</div>
                    <label class="switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Sound Effects</div>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">Trading Preferences</div>
                <div class="setting-item">
                    <div class="setting-label">Default Investment</div>
                    <select class="select-setting">
                        <option>$500</option>
                        <option>$1000</option>
                        <option>$2500</option>
                        <option>$5000</option>
                    </select>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Risk Level</div>
                    <select class="select-setting">
                        <option>Low</option>
                        <option>Medium</option>
                        <option>High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Auto-Trade Signals</div>
                    <label class="switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">Appearance</div>
                <div class="setting-item">
                    <div class="setting-label">Dark Mode</div>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Compact View</div>
                    <label class="switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">Account</div>
                <div class="setting-item">
                    <div class="setting-label">Account Type</div>
                    <div>Premium</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Member Since</div>
                    <div>Jan 2024</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Logout</div>
                    <button class="action-btn" style="padding: 5px 10px; font-size: 12px;">Logout</button>
                </div>
            </div>
        </div>
        
        <div class="disclaimer">
            <strong>Disclaimer:</strong> Trading involves substantial risk of loss and is not suitable for every investor. The suggestions provided are for informational purposes only. You should not construe any such information as legal, tax, investment, financial, or other advice. Past performance is not indicative of future results.
        </div>
        
        <div class="bottom-nav">
            <div class="nav-item active" data-section="opportunities">
                <div class="nav-icon">📈</div>
                <div>Opportunities</div>
            </div>
            <div class="nav-item" data-section="experts">
                <div class="nav-icon">👥</div>
                <div>Experts</div>
            </div>
            <div class="nav-item" data-section="portfolio">
                <div class="nav-icon">💼</div>
                <div>Portfolio</div>
            </div>
            <div class="nav-item" data-section="settings">
                <div class="nav-icon">⚙️</div>
                <div>Settings</div>
            </div>
        </div>
    </div>

    <script src="https://clearpro-trading.onrender.com/socket.io/socket.io.js"></script>
    <script>
        // Enhanced JavaScript for Real-time Functionality - NO MOCK DATA
        class ClearProTradingApp {
            constructor() {
                this.socket = null;
                this.currentSignals = [];
                this.currentExperts = [];
                this.currentPortfolio = null;
                this.activeTrades = [];
                this.activeFilter = 'all';
                this.currentSection = 'opportunities';
                this.isConnected = false;
                this.backendUrl = 'https://clearpro-trading.onrender.com';
                this.dataLoaded = false;
                
                this.init();
            }
            
            init() {
                this.connectSocket();
                this.setupEventListeners();
                this.loadInitialData();
                this.setupSwipeRefresh();
            }
            
            connectSocket() {
                this.socket = io(this.backendUrl);
                const connectionStatus = document.getElementById('connectionStatus');
                
                this.socket.on('connect', () => {
                    console.log('Connected to server');
                    this.isConnected = true;
                    connectionStatus.textContent = 'Live';
                    connectionStatus.className = 'connection-status connected';
                    this.showToast('Connected to live trading data', 'success');
                });
                
                this.socket.on('disconnect', () => {
                    console.log('Disconnected from server');
                    this.isConnected = false;
                    connectionStatus.textContent = 'Offline';
                    connectionStatus.className = 'connection-status disconnected';
                    this.showToast('Connection lost - Reconnecting...', 'error');
                });
                
                this.socket.on('connect_error', (error) => {
                    console.error('Connection error:', error);
                    this.showToast('Failed to connect to trading server', 'error');
                    this.showConnectionError();
                });
                
                this.socket.on('signals', (signals) => {
                    console.log('Received live signals:', signals);
                    this.currentSignals = signals;
                    this.displaySignals(signals);
                    this.dataLoaded = true;
                });
                
                this.socket.on('new-signals', (newSignals) => {
                    console.log('Received new signals:', newSignals);
                    this.currentSignals = [...newSignals, ...this.currentSignals].slice(0, 20);
                    this.displayNewSignals(newSignals);
                    this.showToast(`${newSignals.length} new trading signals`, 'info');
                });
                
                this.socket.on('portfolio-update', (portfolio) => {
                    console.log('Received portfolio update:', portfolio);
                    this.currentPortfolio = portfolio;
                    this.updatePortfolio(portfolio);
                    this.dataLoaded = true;
                });
                
                this.socket.on('experts', (experts) => {
                    console.log('Received experts data:', experts);
                    this.currentExperts = experts;
                    this.displayExperts(experts);
                    this.dataLoaded = true;
                });
            }
            
            setupEventListeners() {
                // Filter tabs
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.setActiveFilter(e.target.getAttribute('data-filter'));
                    });
                });
                
                // Bottom navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        this.switchSection(e.currentTarget.getAttribute('data-section'));
                    });
                });
                
                // View all buttons
                document.getElementById('viewAllSignals').addEventListener('click', () => {
                    this.showAllSignals();
                });
                
                document.getElementById('viewAllExperts').addEventListener('click', () => {
                    this.showAllExperts();
                });
                
                // User menu
                document.getElementById('userMenu').addEventListener('click', () => {
                    this.showUserMenu();
                });
                
                // Modal close buttons
                document.getElementById('closeTradeModal').addEventListener('click', () => {
                    this.closeModal('tradeModal');
                });
                
                document.getElementById('closeSignalModal').addEventListener('click', () => {
                    this.closeModal('signalModal');
                });
                
                // Click outside modal to close
                document.getElementById('tradeModal').addEventListener('click', (e) => {
                    if (e.target.id === 'tradeModal') {
                        this.closeModal('tradeModal');
                    }
                });
                
                document.getElementById('signalModal').addEventListener('click', (e) => {
                    if (e.target.id === 'signalModal') {
                        this.closeModal('signalModal');
                    }
                });
                
                // Enhanced trade execution with event delegation
                document.getElementById('opportunitiesContainer').addEventListener('click', (e) => {
                    if (e.target.classList.contains('action-btn')) {
                        const card = e.target.closest('.opportunity-card');
                        const signalId = card.getAttribute('data-id');
                        const signal = this.currentSignals.find(s => s.id == signalId);
                        if (signal) {
                            this.executeTrade(signal);
                        }
                    }
                    
                    // Card click for details
                    if (e.target.closest('.opportunity-card') && !e.target.classList.contains('action-btn')) {
                        const card = e.target.closest('.opportunity-card');
                        const signalId = card.getAttribute('data-id');
                        const signal = this.currentSignals.find(s => s.id == signalId);
                        if (signal) {
                            this.showSignalDetails(signal);
                        }
                    }
                });

                // Settings switches
                document.querySelectorAll('.switch input').forEach(switchEl => {
                    switchEl.addEventListener('change', (e) => {
                        const setting = e.target.closest('.setting-item').querySelector('.setting-label').textContent;
                        this.showToast(`${setting} ${e.target.checked ? 'enabled' : 'disabled'}`, 'info');
                    });
                });

                // Settings selects
                document.querySelectorAll('.select-setting').forEach(select => {
                    select.addEventListener('change', (e) => {
                        const setting = e.target.closest('.setting-item').querySelector('.setting-label').textContent;
                        this.showToast(`${setting} updated to ${e.target.value}`, 'info');
                    });
                });
            }
            
            setupSwipeRefresh() {
                let startY = 0;
                let currentY = 0;
                const pullToRefresh = document.getElementById('pullToRefresh');
                const container = document.querySelector('.container');
                
                container.addEventListener('touchstart', (e) => {
                    if (window.scrollY === 0) {
                        startY = e.touches[0].pageY;
                    }
                });
                
                container.addEventListener('touchmove', (e) => {
                    if (startY && window.scrollY === 0) {
                        currentY = e.touches[0].pageY;
                        const diff = currentY - startY;
                        
                        if (diff > 0) {
                            e.preventDefault();
                            pullToRefresh.style.transform = `translateY(${Math.min(diff, 60)}px)`;
                            pullToRefresh.textContent = diff > 50 ? '↻ Release to refresh' : '↓ Pull to refresh';
                        }
                    }
                });
                
                container.addEventListener('touchend', () => {
                    if (currentY - startY > 50) {
                        this.refreshData();
                    }
                    startY = 0;
                    currentY = 0;
                    pullToRefresh.style.transform = 'translateY(0)';
                    pullToRefresh.textContent = '↓ Pull to refresh';
                });
            }
            
            async loadInitialData() {
                try {
                    this.showToast('Loading live trading data...', 'info');
                    
                    const [signalsResponse, expertsResponse, portfolioResponse] = await Promise.all([
                        fetch(`${this.backendUrl}/api/signals`),
                        fetch(`${this.backendUrl}/api/experts`),
                        fetch(`${this.backendUrl}/api/portfolio`)
                    ]);
                    
                    if (!signalsResponse.ok) throw new Error('Failed to load signals from server');
                    if (!expertsResponse.ok) throw new Error('Failed to load experts from server');
                    if (!portfolioResponse.ok) throw new Error('Failed to load portfolio from server');
                    
                    const signals = await signalsResponse.json();
                    const experts = await expertsResponse.json();
                    const portfolio = await portfolioResponse.json();
                    
                    this.currentSignals = signals;
                    this.currentExperts = experts;
                    this.currentPortfolio = portfolio;
                    
                    this.displaySignals(signals);
                    this.displayExperts(experts);
                    this.updatePortfolio(portfolio);
                    
                    this.dataLoaded = true;
                    this.showToast('Live data loaded successfully', 'success');
                    
                } catch (error) {
                    console.error('Error loading initial data:', error);
                    this.showToast('Failed to load live trading data', 'error');
                    this.showDataError();
                }
            }

            showConnectionError() {
                const container = document.getElementById('opportunitiesContainer');
                container.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">🔌</div>
                        <h3>Connection Failed</h3>
                        <p>Unable to connect to trading server. Please check your internet connection and try again.</p>
                        <button class="retry-btn" onclick="app.retryConnection()">Retry Connection</button>
                    </div>
                `;
            }

            showDataError() {
                const container = document.getElementById('opportunitiesContainer');
                container.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">⚠️</div>
                        <h3>Data Unavailable</h3>
                        <p>Unable to load live trading data from the server. The server might be temporarily unavailable.</p>
                        <button class="retry-btn" onclick="app.refreshData()">Retry Loading</button>
                    </div>
                `;
            }

            retryConnection() {
                this.showToast('Reconnecting to server...', 'info');
                this.connectSocket();
                this.loadInitialData();
            }
            
            async refreshData() {
                this.showToast('Refreshing live data...', 'info');
                await this.loadInitialData();
            }
            
            displaySignals(signals) {
                const container = document.getElementById('opportunitiesContainer');
                
                if (!signals || signals.length === 0) {
                    container.innerHTML = '<div class="loading">No live trading signals available at the moment</div>';
                    return;
                }
                
                const filteredSignals = this.filterSignals(signals, this.activeFilter);
                
                if (filteredSignals.length === 0) {
                    container.innerHTML = '<div class="loading">No signals match your current filter</div>';
                    return;
                }
                
                container.innerHTML = filteredSignals.map(signal => {
                    // Determine asset type from symbol or asset name
                    let assetType = 'stock';
                    const assetUpper = signal.asset.toUpperCase();
                    const symbolUpper = signal.symbol ? signal.symbol.toUpperCase() : '';
                    
                    if (assetUpper.includes('FOREX') || assetUpper.includes('/') || 
                        symbolUpper.includes('EUR') || symbolUpper.includes('USD') || 
                        symbolUpper.includes('JPY') || symbolUpper.includes('GBP')) {
                        assetType = 'forex';
                    } else if (assetUpper.includes('CRYPTO') || assetUpper.includes('BTC') || 
                               assetUpper.includes('ETH') || assetUpper.includes('XRP') ||
                               symbolUpper.includes('BTC') || symbolUpper.includes('ETH')) {
                        assetType = 'crypto';
                    }
                    
                    const badgeClass = `badge-${assetType}`;
                    const assetTypeLabel = assetType === 'forex' ? 'FOREX' : 
                                          assetType === 'crypto' ? 'CRYPTO' : 'STOCK';
                    
                    return `
                    <div class="opportunity-card ${assetType}" data-id="${signal.id}">
                        <div class="opportunity-header">
                            <div>
                                <div class="asset">${signal.asset}</div>
                                <div class="asset-type">Live Signal • <span class="asset-badge ${badgeClass}">${assetTypeLabel}</span></div>
                            </div>
                            <div class="trend trend-${signal.trend}">${signal.trend === 'up' ? '📈 Bullish' : '📉 Bearish'}</div>
                        </div>
                        <div class="opportunity-details">
                            <div class="expert">👤 ${signal.expert}</div>
                            <div class="risk-level risk-${signal.risk}">${signal.risk.charAt(0).toUpperCase() + signal.risk.slice(1)} Risk</div>
                        </div>
                        <div class="opportunity-details">
                            <div>🎯 Entry: ${signal.entry}</div>
                            <div>💰 Target: ${signal.target}</div>
                        </div>
                        <div class="opportunity-details">
                            <div>🛡️ Stop Loss: ${signal.stopLoss}</div>
                            <div>⏰ Expires: ${new Date(signal.expiry).toLocaleDateString()}</div>
                        </div>
                        <div class="opportunity-footer">
                            <div class="time-remaining">
                                Live: ${assetType === 'forex' ? '' : '$'}${signal.currentPrice} 
                                <span class="${signal.priceChange >= 0 ? 'price-up' : 'price-down'}">
                                    ${signal.priceChange >= 0 ? '↗' : '↘'} ${Math.abs(signal.priceChange)}%
                                </span>
                            </div>
                            <button class="action-btn">Trade Now</button>
                        </div>
                    </div>
                `}).join('');
            }
            
            displayNewSignals(newSignals) {
                const container = document.getElementById('opportunitiesContainer');
                const filteredSignals = this.filterSignals(newSignals, this.activeFilter);
                
                filteredSignals.forEach(signal => {
                    let assetType = 'stock';
                    const assetUpper = signal.asset.toUpperCase();
                    const symbolUpper = signal.symbol ? signal.symbol.toUpperCase() : '';
                    
                    if (assetUpper.includes('FOREX') || assetUpper.includes('/') || 
                        symbolUpper.includes('EUR') || symbolUpper.includes('USD')) {
                        assetType = 'forex';
                    } else if (assetUpper.includes('CRYPTO') || assetUpper.includes('BTC') || 
                               symbolUpper.includes('BTC') || symbolUpper.includes('ETH')) {
                        assetType = 'crypto';
                    }
                    
                    const badgeClass = `badge-${assetType}`;
                    const assetTypeLabel = assetType === 'forex' ? 'FOREX' : 
                                          assetType === 'crypto' ? 'CRYPTO' : 'STOCK';
                    
                    const signalElement = document.createElement('div');
                    signalElement.className = `opportunity-card ${assetType} new`;
                    signalElement.setAttribute('data-id', signal.id);
                    signalElement.innerHTML = `
                        <div class="opportunity-header">
                            <div>
                                <div class="asset">${signal.asset} <span class="asset-badge ${badgeClass}">${assetTypeLabel}</span> 🔥 NEW</div>
                            </div>
                            <div class="trend trend-${signal.trend}">${signal.trend === 'up' ? '📈 Bullish' : '📉 Bearish'}</div>
                        </div>
                        <div class="opportunity-details">
                            <div class="expert">👤 ${signal.expert}</div>
                            <div class="risk-level risk-${signal.risk}">${signal.risk.charAt(0).toUpperCase() + signal.risk.slice(1)} Risk</div>
                        </div>
                        <div class="opportunity-details">
                            <div>🎯 Entry: ${signal.entry}</div>
                            <div>💰 Target: ${signal.target}</div>
                        </div>
                        <div class="opportunity-details">
                            <div>🛡️ Stop Loss: ${signal.stopLoss}</div>
                            <div>⏰ Expires: ${new Date(signal.expiry).toLocaleDateString()}</div>
                        </div>
                        <div class="opportunity-footer">
                            <div class="time-remaining">
                                Live: ${assetType === 'forex' ? '' : '$'}${signal.currentPrice} 
                                <span class="${signal.priceChange >= 0 ? 'price-up' : 'price-down'}">
                                    ${signal.priceChange >= 0 ? '↗' : '↘'} ${Math.abs(signal.priceChange)}%
                                </span>
                            </div>
                            <button class="action-btn">Trade Now</button>
                        </div>
                    `;
                    container.insertBefore(signalElement, container.firstChild);
                });
            }
            
            displayExperts(experts) {
                const container = document.getElementById('expertsContainer');
                
                if (!experts || experts.length === 0) {
                    container.innerHTML = '<div class="loading">No expert data available from server</div>';
                    return;
                }
                
                container.innerHTML = experts.map(expert => `
                    <div class="expert-card" data-id="${expert.id}">
                        <div class="expert-avatar">${expert.avatar}</div>
                        <div class="expert-info">
                            <div class="expert-name">${expert.name}</div>
                            <div class="expert-specialty">${expert.specialty}</div>
                            <div class="expert-rating">
                                <span class="rating-stars">${'★'.repeat(Math.floor(expert.rating))}${expert.rating % 1 >= 0.5 ? '½' : ''}</span>
                                <span>${expert.rating} (${expert.reviews} reviews) - ${expert.successRate}% Success</span>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            updatePortfolio(portfolio) {
                const dashboard = document.getElementById('portfolioDashboard');
                let profitElement = dashboard.querySelector('.profit-positive') || dashboard.querySelector('.profit-negative');
                
                if (!profitElement) {
                    const profitDiv = dashboard.querySelector('.profit');
                    profitElement = document.createElement('div');
                    profitElement.className = 'profit-positive';
                    profitDiv.appendChild(profitElement);
                }
                
                dashboard.querySelector('.balance-amount').textContent = `$${portfolio.portfolioValue.toFixed(2)}`;
                
                const profitClass = portfolio.dailyProfit >= 0 ? 'profit-positive' : 'profit-negative';
                const profitSign = portfolio.dailyProfit >= 0 ? '+' : '';
                profitElement.className = profitClass;
                profitElement.textContent = `${profitSign}$${portfolio.dailyProfit.toFixed(2)}`;
                
                const statValues = dashboard.querySelectorAll('.stat-value');
                statValues[0].textContent = portfolio.openTrades;
                statValues[1].textContent = `${portfolio.winRate}%`;
                statValues[2].textContent = portfolio.riskRatio.toFixed(1);
            }
            
            setActiveFilter(filter) {
                this.activeFilter = filter;
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
                
                if (this.dataLoaded) {
                    this.displaySignals(this.currentSignals);
                }
            }
            
            filterSignals(signals, filter) {
                if (filter === 'all') return signals;
                
                return signals.filter(signal => {
                    let assetType = 'stock';
                    const assetUpper = signal.asset.toUpperCase();
                    const symbolUpper = signal.symbol ? signal.symbol.toUpperCase() : '';
                    
                    if (assetUpper.includes('FOREX') || assetUpper.includes('/') || 
                        symbolUpper.includes('EUR') || symbolUpper.includes('USD')) {
                        assetType = 'forex';
                    } else if (assetUpper.includes('CRYPTO') || assetUpper.includes('BTC') || 
                               symbolUpper.includes('BTC') || symbolUpper.includes('ETH')) {
                        assetType = 'crypto';
                    }
                    
                    const risk = signal.risk.toLowerCase();
                    
                    switch(filter) {
                        case 'stocks':
                            return assetType === 'stock';
                        case 'forex':
                            return assetType === 'forex';
                        case 'crypto':
                            return assetType === 'crypto';
                        case 'low':
                            return risk === 'low';
                        default:
                            return true;
                    }
                });
            }
            
            switchSection(section) {
                this.currentSection = section;
                
                // Update navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-section="${section}"]`).classList.add('active');
                
                // Update sections
                document.querySelectorAll('.section').forEach(sec => {
                    sec.classList.remove('active');
                });
                document.getElementById(`${section}Section`).classList.add('active');
                
                this.showToast(`Switched to ${section}`, 'info');
            }
            
            executeTrade(signal) {
                const modal = document.getElementById('tradeModal');
                const modalBody = document.getElementById('tradeModalBody');
                const modalTitle = document.getElementById('tradeModalTitle');
                
                let assetType = 'stock';
                const assetUpper = signal.asset.toUpperCase();
                
                if (assetUpper.includes('FOREX') || assetUpper.includes('/')) {
                    assetType = 'forex';
                } else if (assetUpper.includes('CRYPTO') || assetUpper.includes('BTC')) {
                    assetType = 'crypto';
                }
                
                const isForex = assetType === 'forex';
                
                modalTitle.textContent = `Execute Live Trade: ${signal.asset}`;
                modalBody.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <div><strong>Live Signal Details:</strong></div>
                        <div>Type: ${assetType.toUpperCase()}</div>
                        <div>Trend: ${signal.trend === 'up' ? 'Bullish 📈' : 'Bearish 📉'}</div>
                        <div>Expert: ${signal.expert}</div>
                        <div>Risk: <span class="risk-level risk-${signal.risk}">${signal.risk.charAt(0).toUpperCase() + signal.risk.slice(1)}</span></div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div><strong>Live Trade Parameters:</strong></div>
                        <div>Entry: ${signal.entry}</div>
                        <div>Target: ${signal.target}</div>
                        <div>Stop Loss: ${signal.stopLoss}</div>
                        <div>Current Price: ${isForex ? '' : '$'}${signal.currentPrice}</div>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label for="tradeAmount" style="display: block; margin-bottom: 5px;">
                            Investment Amount ${isForex ? '(Lots)' : '($)'}:
                        </label>
                        <input type="number" id="tradeAmount" value="${isForex ? '1' : '1000'}" 
                               min="${isForex ? '0.1' : '100'}" max="${isForex ? '10' : '10000'}" 
                               step="${isForex ? '0.1' : '100'}" 
                               style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #2d3748; background: #1e293b; color: white;">
                    </div>
                    <button id="confirmTrade" style="width: 100%; padding: 12px; background: #4caf50; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
                        Execute Live Trade
                    </button>
                `;
                
                modal.style.display = 'flex';
                
                document.getElementById('confirmTrade').addEventListener('click', () => {
                    const amount = document.getElementById('tradeAmount').value;
                    this.processTrade(signal, amount);
                });
            }
            
            async processTrade(signal, amount) {
                try {
                    this.showToast('Executing live trade...', 'info');
                    
                    // In a real app, you would call your backend API here
                    // const response = await fetch('/api/execute-trade', {
                    //     method: 'POST',
                    //     headers: { 'Content-Type': 'application/json' },
                    //     body: JSON.stringify({ signal, amount })
                    // });
                    
                    // Simulate API delay for real trading execution
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    this.closeModal('tradeModal');
                    
                    let assetType = 'stock';
                    const assetUpper = signal.asset.toUpperCase();
                    
                    if (assetUpper.includes('FOREX') || assetUpper.includes('/')) {
                        assetType = 'forex';
                    } else if (assetUpper.includes('CRYPTO') || assetUpper.includes('BTC')) {
                        assetType = 'crypto';
                    }
                    
                    const isForex = assetType === 'forex';
                    const amountDisplay = isForex ? `${amount} lots` : `$${amount}`;
                    
                    this.showToast(`Live trade executed for ${amountDisplay} on ${signal.asset.split(' - ')[0]}`, 'success');
                    
                    // Refresh live data
                    this.refreshData();
                    
                } catch (error) {
                    console.error('Live trade execution error:', error);
                    this.showToast('Live trade execution failed', 'error');
                }
            }
            
            showSignalDetails(signal) {
                const modal = document.getElementById('signalModal');
                const modalBody = document.getElementById('signalModalBody');
                const modalTitle = document.getElementById('signalModalTitle');
                
                let assetType = 'stock';
                const assetUpper = signal.asset.toUpperCase();
                
                if (assetUpper.includes('FOREX') || assetUpper.includes('/')) {
                    assetType = 'forex';
                } else if (assetUpper.includes('CRYPTO') || assetUpper.includes('BTC')) {
                    assetType = 'crypto';
                }
                
                const isForex = assetType === 'forex';
                
                modalTitle.textContent = `Live Signal Details: ${signal.asset}`;
                modalBody.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <div><strong>Live Expert Analysis:</strong></div>
                        <div>Type: ${assetType.toUpperCase()}</div>
                        <div>Expert: ${signal.expert}</div>
                        <div>Trend: ${signal.trend === 'up' ? 'Bullish 📈' : 'Bearish 📉'}</div>
                        <div>Risk Level: <span class="risk-level risk-${signal.risk}">${signal.risk.charAt(0).toUpperCase() + signal.risk.slice(1)}</span></div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div><strong>Live Trading Parameters:</strong></div>
                        <div>Entry Range: ${signal.entry}</div>
                        <div>Target Price: ${signal.target}</div>
                        <div>Stop Loss: ${signal.stopLoss}</div>
                        <div>Current Live Price: ${isForex ? '' : '$'}${signal.currentPrice}</div>
                        <div>Live Price Change: <span class="${signal.priceChange >= 0 ? 'price-up' : 'price-down'}">${signal.priceChange >= 0 ? '+' : ''}${signal.priceChange}%</span></div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div><strong>Live Timing:</strong></div>
                        <div>Signal Generated: ${new Date(signal.timestamp).toLocaleString()}</div>
                        <div>Expires: ${new Date(signal.expiry).toLocaleString()}</div>
                    </div>
                    <button onclick="app.executeTrade(${JSON.stringify(signal).replace(/"/g, '&quot;')})" 
                            style="width: 100%; padding: 12px; background: #4fc3f7; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px;">
                        Execute Live Trade
                    </button>
                `;
                
                modal.style.display = 'flex';
            }
            
            showAllSignals() {
                if (this.dataLoaded) {
                    this.displaySignals(this.currentSignals);
                    this.showToast('Showing all live signals', 'info');
                } else {
                    this.showToast('Loading live signals...', 'info');
                }
            }
            
            showAllExperts() {
                if (this.dataLoaded) {
                    this.displayExperts(this.currentExperts);
                    this.showToast('Showing all live experts', 'info');
                } else {
                    this.showToast('Loading expert data...', 'info');
                }
            }
            
            showUserMenu() {
                this.showToast('User profile menu', 'info');
            }
            
            closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }
            
            showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = `toast show ${type}`;
                
                setTimeout(() => {
                    toast.className = 'toast';
                }, 3000);
            }
        }
        
        // Initialize the app when DOM is loaded
        let app;
        document.addEventListener('DOMContentLoaded', function() {
            app = new ClearProTradingApp();
        });
        
        // Android app specific functions
        if (window.Android) {
            window.Android.interfaceReady = function() {
                console.log('Android interface ready');
            };
        }
        
        // Prevent zoom on double-tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
        
        // Service Worker Registration for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
